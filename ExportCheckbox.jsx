/* * Author: *   Gil Polguère *   Github: https://github.com/gpolguere *   Twitter: @slurpsappy *    Email: gpolguere@gmail.com */// In order to make it work : Preferences > General > Check "Allow Scripts to Write Files and Access Network"(function ExportCheckbox() {	var comp = app.project.activeItem;	var selectedLayers = comp.selectedLayers;	if(selectedLayers.length == 0) {		alert("No layer selected");		return;	}	var layer = selectedLayers[0];	var effects = layer("Effects");	if(effects == undefined) {		alert("No effect layer");		return;	}	var checkboxLayer = null;	for(var i = 0; i < effects.numProperties; i++) {		checkboxLayer = effects(i + 1);		if(checkboxLayer.matchName == "ADBE Checkbox Control") {			break;		}	}	if(checkboxLayer == null) {		alert("No checkbox layer");		return;	}	var checkbox = checkboxLayer(1);	var jsonStr = "[";	for(var i = 0; i < checkbox.numKeys; i++) {		jsonStr += "{";		jsonStr += "\"time\":" + "\"" + checkbox.keyTime(i + 1) + "\",";		jsonStr += "\"value\":" + "\"" + checkbox.keyValue(i + 1) + "\"";		jsonStr += "}";		if(i < checkbox.numKeys - 1) {			jsonStr += ",";		}	}	jsonStr += "]";	//$.writeln(jsonStr);	var newFile = File.saveDialog("Save JSON file");	var f = new File(newFile);	f.open("w");	try {		f.write(jsonStr);	} catch(error) {		alert(error);	}	f.close();})();